{"version":3,"sources":["/Users/erunion/code/readme/remove-undefined-objects/dist/index.js","../src/index.ts"],"names":[],"mappings":"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","file":"/Users/erunion/code/readme/remove-undefined-objects/dist/index.js","sourcesContent":[null,"function isObject(obj: unknown) {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj);\n}\n\nfunction isEmptyObject(obj: unknown) {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj) && !Object.keys(obj).length;\n}\n\nfunction isEmptyArray(arr: unknown) {\n  return Array.isArray(arr) && arr.length === 0;\n}\n\ninterface RemovalOptions {\n  preserveEmptyArray?: boolean;\n  preserveNullishArrays?: boolean;\n  removeAllFalsy?: boolean;\n}\n\n// Remove objects that has undefined value or recursively contain undefined values\n// biome-ignore lint/suspicious/noExplicitAny: This method does its own type assertions.\nfunction removeUndefined(obj: any): any {\n  if (obj === undefined) {\n    return undefined;\n  }\n  // Preserve null\n  if (obj === null) {\n    return null;\n  }\n  // Remove undefined in arrays\n  if (Array.isArray(obj)) {\n    return obj.map(removeUndefined).filter(item => item !== undefined);\n  }\n  if (typeof obj === 'object') {\n    // biome-ignore lint/suspicious/noExplicitAny: We're just passing around the object values\n    const cleaned: Record<string, any> = {};\n    Object.entries(obj).forEach(([key, value]) => {\n      const cleanedValue = removeUndefined(value);\n      if (cleanedValue !== undefined) {\n        cleaned[key] = cleanedValue;\n      }\n    });\n    return cleaned;\n  }\n  return obj;\n}\n\n// Modified from here: https://stackoverflow.com/a/43781499\n// biome-ignore lint/suspicious/noExplicitAny: This method does its own type assertions.\nfunction stripEmptyObjects(obj: any, options: RemovalOptions = {}) {\n  const cleanObj = obj;\n\n  if (obj === null && options.removeAllFalsy) {\n    return undefined;\n  }\n\n  if (!isObject(obj) && !Array.isArray(cleanObj)) {\n    return cleanObj;\n  }\n\n  if (!Array.isArray(cleanObj)) {\n    Object.keys(cleanObj).forEach(key => {\n      let value = cleanObj[key];\n\n      if (typeof value !== 'object') {\n        return;\n      }\n\n      if (value === null) {\n        if (options.removeAllFalsy) {\n          delete cleanObj[key];\n        }\n        return;\n      }\n\n      value = stripEmptyObjects(value, options);\n\n      if (isEmptyObject(value)) {\n        delete cleanObj[key];\n      } else if (isEmptyArray(value) && !options.preserveEmptyArray) {\n        delete cleanObj[key];\n      } else {\n        cleanObj[key] = value;\n      }\n    });\n\n    return cleanObj;\n  }\n\n  cleanObj.forEach((o, idx) => {\n    let value = o;\n    if (typeof value === 'object' && value !== null) {\n      value = stripEmptyObjects(value, options);\n\n      if (isEmptyObject(value)) {\n        delete cleanObj[idx];\n      } else if (isEmptyArray(value) && !options.preserveEmptyArray) {\n        delete cleanObj[idx];\n      } else {\n        cleanObj[idx] = value;\n      }\n    } else if (value === null && (options.removeAllFalsy || !options.preserveNullishArrays)) {\n      // Null entries within an array should be removed by default, unless explicitly preserved\n      delete cleanObj[idx];\n    }\n  });\n\n  // Since deleting a key from an array will retain an undefined value in that array, we need to\n  // filter them out.\n  return cleanObj.filter(el => el !== undefined);\n}\n\nexport default function removeUndefinedObjects<T>(obj?: T, options?: RemovalOptions): T | undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n\n  // If array nulls are preserved, use the custom removeUndefined function so that\n  // undefined values in arrays aren't converted to nulls, which stringify does\n  // If we're not preserving array nulls (default behavior), it doesn't matter that the undefined array values are converted to nulls\n  let withoutUndefined = options?.preserveNullishArrays ? removeUndefined(obj) : JSON.parse(JSON.stringify(obj));\n\n  // Then we recursively remove all empty objects and nullish arrays\n  withoutUndefined = stripEmptyObjects(withoutUndefined, options);\n\n  // If the only thing that's leftover is an empty object or empty array then return nothing.\n  if (isEmptyObject(withoutUndefined) || (isEmptyArray(withoutUndefined) && !options?.preserveEmptyArray))\n    return undefined;\n\n  return withoutUndefined;\n}\n"]}