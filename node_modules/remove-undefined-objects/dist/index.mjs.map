{"version":3,"sources":["../src/index.ts"],"sourcesContent":["function isObject(obj: unknown) {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj);\n}\n\nfunction isEmptyObject(obj: unknown) {\n  return typeof obj === 'object' && obj !== null && !Array.isArray(obj) && !Object.keys(obj).length;\n}\n\nfunction isEmptyArray(arr: unknown) {\n  return Array.isArray(arr) && arr.length === 0;\n}\n\ninterface RemovalOptions {\n  preserveEmptyArray?: boolean;\n  preserveNullishArrays?: boolean;\n  removeAllFalsy?: boolean;\n}\n\n// Remove objects that has undefined value or recursively contain undefined values\n// biome-ignore lint/suspicious/noExplicitAny: This method does its own type assertions.\nfunction removeUndefined(obj: any): any {\n  if (obj === undefined) {\n    return undefined;\n  }\n  // Preserve null\n  if (obj === null) {\n    return null;\n  }\n  // Remove undefined in arrays\n  if (Array.isArray(obj)) {\n    return obj.map(removeUndefined).filter(item => item !== undefined);\n  }\n  if (typeof obj === 'object') {\n    // biome-ignore lint/suspicious/noExplicitAny: We're just passing around the object values\n    const cleaned: Record<string, any> = {};\n    Object.entries(obj).forEach(([key, value]) => {\n      const cleanedValue = removeUndefined(value);\n      if (cleanedValue !== undefined) {\n        cleaned[key] = cleanedValue;\n      }\n    });\n    return cleaned;\n  }\n  return obj;\n}\n\n// Modified from here: https://stackoverflow.com/a/43781499\n// biome-ignore lint/suspicious/noExplicitAny: This method does its own type assertions.\nfunction stripEmptyObjects(obj: any, options: RemovalOptions = {}) {\n  const cleanObj = obj;\n\n  if (obj === null && options.removeAllFalsy) {\n    return undefined;\n  }\n\n  if (!isObject(obj) && !Array.isArray(cleanObj)) {\n    return cleanObj;\n  }\n\n  if (!Array.isArray(cleanObj)) {\n    Object.keys(cleanObj).forEach(key => {\n      let value = cleanObj[key];\n\n      if (typeof value !== 'object') {\n        return;\n      }\n\n      if (value === null) {\n        if (options.removeAllFalsy) {\n          delete cleanObj[key];\n        }\n        return;\n      }\n\n      value = stripEmptyObjects(value, options);\n\n      if (isEmptyObject(value)) {\n        delete cleanObj[key];\n      } else if (isEmptyArray(value) && !options.preserveEmptyArray) {\n        delete cleanObj[key];\n      } else {\n        cleanObj[key] = value;\n      }\n    });\n\n    return cleanObj;\n  }\n\n  cleanObj.forEach((o, idx) => {\n    let value = o;\n    if (typeof value === 'object' && value !== null) {\n      value = stripEmptyObjects(value, options);\n\n      if (isEmptyObject(value)) {\n        delete cleanObj[idx];\n      } else if (isEmptyArray(value) && !options.preserveEmptyArray) {\n        delete cleanObj[idx];\n      } else {\n        cleanObj[idx] = value;\n      }\n    } else if (value === null && (options.removeAllFalsy || !options.preserveNullishArrays)) {\n      // Null entries within an array should be removed by default, unless explicitly preserved\n      delete cleanObj[idx];\n    }\n  });\n\n  // Since deleting a key from an array will retain an undefined value in that array, we need to\n  // filter them out.\n  return cleanObj.filter(el => el !== undefined);\n}\n\nexport default function removeUndefinedObjects<T>(obj?: T, options?: RemovalOptions): T | undefined {\n  if (obj === undefined) {\n    return undefined;\n  }\n\n  // If array nulls are preserved, use the custom removeUndefined function so that\n  // undefined values in arrays aren't converted to nulls, which stringify does\n  // If we're not preserving array nulls (default behavior), it doesn't matter that the undefined array values are converted to nulls\n  let withoutUndefined = options?.preserveNullishArrays ? removeUndefined(obj) : JSON.parse(JSON.stringify(obj));\n\n  // Then we recursively remove all empty objects and nullish arrays\n  withoutUndefined = stripEmptyObjects(withoutUndefined, options);\n\n  // If the only thing that's leftover is an empty object or empty array then return nothing.\n  if (isEmptyObject(withoutUndefined) || (isEmptyArray(withoutUndefined) && !options?.preserveEmptyArray))\n    return undefined;\n\n  return withoutUndefined;\n}\n"],"mappings":"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","names":[]}